<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>E.5.4. Post-processing for Allied Models</title><link rel="stylesheet" href="fpa-style.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.69.1" /><link rel="start" href="index.html" title="Forecast Production Assistant Version 8" /><link rel="up" href="apes05.html" title="E.5. FPA Specialized Processing Modules" /><link rel="prev" href="apes05s03.html" title="E.5.3. Executing Allied Models" /><link rel="next" href="apes06.html" title="E.6. Allowing User Access to Tested Allied Models" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">E.5.4. Post-processing for Allied Models</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="apes05s03.html">Prev</a> </td><th width="60%" align="center">E.5. <span class="acronym">FPA</span> Specialized Processing Modules</th><td width="20%" align="right"> <a accesskey="n" href="apes06.html">Next</a></td></tr></table><hr /></div><div class="sect2" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="id2075229"></a>E.5.4. Post-processing for Allied Models</h3></div></div></div><p>
<a id="id2075235" class="indexterm"></a>
The post-processing module is used to re-format Allied Model input or output files into files which can be used within the <span class="acronym">FPA</span>.
This module is a stand-alone program, and is run each time the application is executed.
The program can be run for each subarea by:
</p><pre class="programlisting"><span xmlns="" class="replaceable">allied_post</span> &lt;SETUP&gt; &lt;SOURCE&gt; &lt;SUBSOURCE&gt; &lt;RTIME&gt;</pre><p>
The time at which the application is run (rtime) is used to find the appropriate Data Directory in which to write the <span class="acronym">FPA</span> files.
The data files to be produced are identified in the 'metafiles' section in the 'Sources' block of the Local Configuration file (described above).
</p><p>
The program loops through each time and each metafile, sets the identification field descriptor for the metafile, and extracts a METAFILE Object from the input or output files of the application.
The routine, reads the files identified by the <span xmlns="" class="replaceable">file_alias_name</span> 'inputfile' or 'outputfile', extracts data for the required time as a PLOT Object, and copies the data into a METAFILE Object.
The program then places a lock on the Data Directory using <span class="acronym">FPA</span> Standard Library routine set_shuffle_lock(), builds a file name for the metafile using <span class="acronym">FPA</span> Standard Library routine build_meta_filename(), and outputs the METAFILE Object to the file name using <span class="acronym">FPA</span> Standard Library routine write_metafile().
</p><p>
Code also exists to extract SURFACE Object data from application files.
The process is similar to producing a METAFILE containing a PLOT Object, except that the data for the required time must be converted to a SURFACE Object.
This is done by converting the PLOT Object data to a grid, and identifying the location of each point on the <span class="acronym">FPA</span> basemap with respect to this grid.
For each point on the <span class="acronym">FPA</span> basemap, a 4 by 4 subgrid of data around the point is extracted from the application data, the 4 by 4 subgrid data is converted into a SURFACE Object using <span class="acronym">FPA</span> Standard Library routine grid_surface(), and the value at the point is evaluated using <span class="acronym">FPA</span> Standard Library routine eval_surface().
When values at all points on the <span class="acronym">FPA</span> basemap have been evaluated, the grid of values are then converted into a SURFACE Object using <span class="acronym">FPA</span> Standard Library routine grid_surface().
Data at points within the area that the application covers are extracted from the application data, while data at points outside the area are extrapolated from values at the nearest edge of the application data (which gives the field a 'flattened' appearance beyond the data coverage).
</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="apes05s03.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="apes05.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="apes06.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">E.5.3. Executing Allied Models </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> E.6. Allowing User Access to Tested Allied Models</td></tr></table></div></body></html>
